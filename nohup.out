Reading english - 1grams ...
Reading english - 2grams ...
Reading english - 1grams ...
Reading english - 1grams ...
Reading english - 1grams ...
Reading english - 2grams ...
Processing training data...
Processing test data...
Extracting tokens...
Found 12891 unique tokens.
Populating embedding matrix...
Extracting tokens/ characters...
Found 61 unique charactertokens.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 100, 15, 10)  610         input_2[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 100, 300)     3867600     input_1[0][0]                    
__________________________________________________________________________________________________
time_distributed_2 (TimeDistrib (None, 100, 80)      16320       time_distributed_1[0][0]         
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 100, 380)     0           embedding_1[0][0]                
                                                                 time_distributed_2[0][0]         
__________________________________________________________________________________________________
bidirectional_2 (Bidirectional) (None, 256)          521216      concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 4)            1028        bidirectional_2[0][0]            
==================================================================================================
Total params: 4,406,774
Trainable params: 539,174
Non-trainable params: 3,867,600
__________________________________________________________________________________________________
Starting k-fold cross validation...
----------------------------------------
Fold 1/5
Building model...
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_3 (TimeDistrib (None, 100, 15, 15)  915         input_4[0][0]                    
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 100, 300)     3867600     input_3[0][0]                    
__________________________________________________________________________________________________
time_distributed_4 (TimeDistrib (None, 100, 96)      24576       time_distributed_3[0][0]         
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 100, 396)     0           embedding_3[0][0]                
                                                                 time_distributed_4[0][0]         
__________________________________________________________________________________________________
bidirectional_4 (Bidirectional) (None, 320)          712960      concatenate_2[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 4)            1284        bidirectional_4[0][0]            
==================================================================================================
Total params: 4,607,335
Trainable params: 739,735
Non-trainable params: 3,867,600
__________________________________________________________________________________________________
Train on 24128 samples, validate on 6032 samples
Epoch 1/10
 - 95s - loss: 1.2832 - acc: 0.4857 - precision: 0.2473 - recall: 0.9894 - val_loss: 1.1393 - val_acc: 0.5045 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 2/10
 - 93s - loss: 0.8231 - acc: 0.6419 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.5350 - val_acc: 0.8094 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 3/10
 - 93s - loss: 0.4291 - acc: 0.8466 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.4068 - val_acc: 0.8597 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 4/10
 - 94s - loss: 0.3379 - acc: 0.8790 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3204 - val_acc: 0.8941 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 5/10
 - 93s - loss: 0.2850 - acc: 0.9004 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2993 - val_acc: 0.8985 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 6/10
 - 94s - loss: 0.2535 - acc: 0.9108 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2877 - val_acc: 0.9050 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 7/10
 - 94s - loss: 0.2293 - acc: 0.9184 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2887 - val_acc: 0.9030 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 8/10
 - 93s - loss: 0.2061 - acc: 0.9264 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3527 - val_acc: 0.8901 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 9/10
 - 94s - loss: 0.1852 - acc: 0.9342 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3218 - val_acc: 0.8980 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 10/10
 - 94s - loss: 0.1682 - acc: 0.9382 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3358 - val_acc: 0.9050 - val_precision: 0.2500 - val_recall: 1.0000
True Positives per class :  [2741.  778. 1012.  928.]
False Positives per class :  [184. 156. 138.  95.]
False Negatives per class :  [302.  55.  59. 157.]
Class happy : Precision : 0.833, Recall : 0.934, F1 : 0.881
Class sad : Precision : 0.880, Recall : 0.945, F1 : 0.911
Class angry : Precision : 0.907, Recall : 0.855, F1 : 0.880
Ignoring the Others class, Macro Precision : 0.8734, Macro Recall : 0.9114, Macro F1 : 0.8920
Ignoring the Others class, Micro TP : 2718, FP : 389, FN : 271
Accuracy : 0.9050, Micro Precision : 0.8748, Micro Recall : 0.9093, Micro F1 : 0.8917
----------------------------------------
Fold 2/5
Building model...
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_6 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_5 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_5 (TimeDistrib (None, 100, 15, 15)  915         input_6[0][0]                    
__________________________________________________________________________________________________
embedding_5 (Embedding)         (None, 100, 300)     3867600     input_5[0][0]                    
__________________________________________________________________________________________________
time_distributed_6 (TimeDistrib (None, 100, 96)      24576       time_distributed_5[0][0]         
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 100, 396)     0           embedding_5[0][0]                
                                                                 time_distributed_6[0][0]         
__________________________________________________________________________________________________
bidirectional_6 (Bidirectional) (None, 320)          712960      concatenate_3[0][0]              
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 4)            1284        bidirectional_6[0][0]            
==================================================================================================
Total params: 4,607,335
Trainable params: 739,735
Non-trainable params: 3,867,600
__________________________________________________________________________________________________
Train on 24128 samples, validate on 6032 samples
Epoch 1/10
 - 96s - loss: 1.2388 - acc: 0.4770 - precision: 0.2473 - recall: 0.9894 - val_loss: 0.9081 - val_acc: 0.5275 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 2/10
 - 94s - loss: 0.6968 - acc: 0.7425 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.4076 - val_acc: 0.8619 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 3/10
 - 94s - loss: 0.5175 - acc: 0.8174 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3699 - val_acc: 0.8660 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 4/10
 - 106s - loss: 0.3357 - acc: 0.8811 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3673 - val_acc: 0.8709 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 5/10
 - 114s - loss: 0.2883 - acc: 0.8987 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3447 - val_acc: 0.8840 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 6/10
 - 116s - loss: 0.2517 - acc: 0.9108 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3128 - val_acc: 0.8881 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 7/10
 - 114s - loss: 0.2258 - acc: 0.9209 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2852 - val_acc: 0.8984 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 8/10
 - 114s - loss: 0.2047 - acc: 0.9274 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2823 - val_acc: 0.9068 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 9/10
 - 118s - loss: 0.1780 - acc: 0.9363 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2953 - val_acc: 0.9027 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 10/10
 - 118s - loss: 0.1597 - acc: 0.9419 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3021 - val_acc: 0.9073 - val_precision: 0.2500 - val_recall: 1.0000
True Positives per class :  [2801.  785.  919.  968.]
False Positives per class :  [287.  87.  47. 138.]
False Negatives per class :  [214. 101. 138. 106.]
Class happy : Precision : 0.900, Recall : 0.886, F1 : 0.893
Class sad : Precision : 0.951, Recall : 0.869, F1 : 0.909
Class angry : Precision : 0.875, Recall : 0.901, F1 : 0.888
Ignoring the Others class, Macro Precision : 0.9089, Macro Recall : 0.8856, Macro F1 : 0.8971
Ignoring the Others class, Micro TP : 2672, FP : 272, FN : 345
Accuracy : 0.9073, Micro Precision : 0.9076, Micro Recall : 0.8856, Micro F1 : 0.8965
----------------------------------------
Fold 3/5
Building model...
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_8 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_7 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_7 (TimeDistrib (None, 100, 15, 15)  915         input_8[0][0]                    
__________________________________________________________________________________________________
embedding_7 (Embedding)         (None, 100, 300)     3867600     input_7[0][0]                    
__________________________________________________________________________________________________
time_distributed_8 (TimeDistrib (None, 100, 96)      24576       time_distributed_7[0][0]         
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 100, 396)     0           embedding_7[0][0]                
                                                                 time_distributed_8[0][0]         
__________________________________________________________________________________________________
bidirectional_8 (Bidirectional) (None, 320)          712960      concatenate_4[0][0]              
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 4)            1284        bidirectional_8[0][0]            
==================================================================================================
Total params: 4,607,335
Trainable params: 739,735
Non-trainable params: 3,867,600
__________________________________________________________________________________________________
Train on 24128 samples, validate on 6032 samples
Epoch 1/10
 - 123s - loss: 1.2761 - acc: 0.4803 - precision: 0.2473 - recall: 0.9894 - val_loss: 1.0389 - val_acc: 0.5114 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 2/10
 - 119s - loss: 0.9203 - acc: 0.6239 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.5074 - val_acc: 0.8161 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 3/10
 - 120s - loss: 0.4182 - acc: 0.8493 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3655 - val_acc: 0.8689 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 4/10
 - 119s - loss: 0.3262 - acc: 0.8828 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3225 - val_acc: 0.8878 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 5/10
 - 118s - loss: 0.2832 - acc: 0.9000 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2903 - val_acc: 0.9032 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 6/10
 - 117s - loss: 0.2487 - acc: 0.9125 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3044 - val_acc: 0.8972 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 7/10
 - 115s - loss: 0.2212 - acc: 0.9222 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3373 - val_acc: 0.8871 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 8/10
 - 118s - loss: 0.2006 - acc: 0.9292 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2728 - val_acc: 0.9060 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 9/10
 - 116s - loss: 0.1792 - acc: 0.9359 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.2629 - val_acc: 0.9103 - val_precision: 0.2500 - val_recall: 1.0000
Epoch 10/10
 - 118s - loss: 0.1724 - acc: 0.9390 - precision: 0.2500 - recall: 1.0000 - val_loss: 0.3014 - val_acc: 0.9072 - val_precision: 0.2500 - val_recall: 1.0000
True Positives per class :  [2681.  768. 1041.  982.]
False Positives per class :  [174. 138. 127. 121.]
False Negatives per class :  [313.  61.  54. 132.]
Class happy : Precision : 0.848, Recall : 0.926, F1 : 0.885
Class sad : Precision : 0.891, Recall : 0.951, F1 : 0.920
Class angry : Precision : 0.890, Recall : 0.882, F1 : 0.886
Ignoring the Others class, Macro Precision : 0.8764, Macro Recall : 0.9195, Macro F1 : 0.8975
Ignoring the Others class, Micro TP : 2791, FP : 386, FN : 247
Accuracy : 0.9072, Micro Precision : 0.8785, Micro Recall : 0.9187, Micro F1 : 0.8981

============= Metrics =================
Average Cross-Validation Accuracy : 
0.9065
Average Cross-Validation Micro Precision :
0.8870
Average Cross-Validation Micro Recall :
0.9046
Average Cross-Validation Micro F1 :
0.8955

======================================
Retraining model on entire data to create solution file
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_10 (InputLayer)           (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_9 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_9 (TimeDistrib (None, 100, 15, 15)  915         input_10[0][0]                   
__________________________________________________________________________________________________
embedding_9 (Embedding)         (None, 100, 300)     3867600     input_9[0][0]                    
__________________________________________________________________________________________________
time_distributed_10 (TimeDistri (None, 100, 96)      24576       time_distributed_9[0][0]         
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 100, 396)     0           embedding_9[0][0]                
                                                                 time_distributed_10[0][0]        
__________________________________________________________________________________________________
bidirectional_10 (Bidirectional (None, 320)          712960      concatenate_5[0][0]              
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 4)            1284        bidirectional_10[0][0]           
==================================================================================================
Total params: 4,607,335
Trainable params: 739,735
Non-trainable params: 3,867,600
__________________________________________________________________________________________________
Epoch 1/10
 - 145s - loss: 1.2110 - acc: 0.5020 - precision: 0.2479 - recall: 0.9915
Epoch 2/10
 - 137s - loss: 0.5680 - acc: 0.7921 - precision: 0.2500 - recall: 1.0000
Epoch 3/10
 - 138s - loss: 0.3462 - acc: 0.8770 - precision: 0.2500 - recall: 1.0000
Epoch 4/10
 - 141s - loss: 0.3682 - acc: 0.8688 - precision: 0.2500 - recall: 1.0000
Epoch 5/10
 - 143s - loss: 0.2601 - acc: 0.9080 - precision: 0.2500 - recall: 1.0000
Epoch 6/10
 - 141s - loss: 0.2322 - acc: 0.9176 - precision: 0.2500 - recall: 1.0000
Epoch 7/10
 - 144s - loss: 0.2052 - acc: 0.9264 - precision: 0.2500 - recall: 1.0000
Epoch 8/10
 - 141s - loss: 0.1896 - acc: 0.9332 - precision: 0.2500 - recall: 1.0000
Epoch 9/10
 - 143s - loss: 0.1701 - acc: 0.9394 - precision: 0.2500 - recall: 1.0000
Epoch 10/10
 - 141s - loss: 0.1544 - acc: 0.9426 - precision: 0.2500 - recall: 1.0000
Using TensorFlow backend.
/home/jasabanta/miniconda3/envs/dl/lib/python3.5/site-packages/sklearn/base.py:251: UserWarning: Trying to unpickle estimator LabelPropagation from version 0.18 when using version 0.20.0. This might lead to breaking code or invalid results. Use at your own risk.
  UserWarning)
Creating solution file...
Completed. Model parameters: 
Learning rate : 0.010, LSTM Dim : 128, Dropout : 0.400, Batch_size : 256

Processing training data...
Processing test data...
Extracting tokens...
Found 14838 unique tokens.
Populating embedding matrix...
Extracting tokens/ characters...
Found 134 unique charactertokens.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 100, 15, 10)  1340        input_2[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 100, 300)     4451700     input_1[0][0]                    
__________________________________________________________________________________________________
time_distributed_2 (TimeDistrib (None, 100, 40)      8160        time_distributed_1[0][0]         
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 100, 340)     0           embedding_1[0][0]                
                                                                 time_distributed_2[0][0]         
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 128)          240128      concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 4)            516         lstm_2[0][0]                     
==================================================================================================
Total params: 4,701,844
Trainable params: 250,144
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Retraining model on entire data to create solution file
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_3 (TimeDistrib (None, 100, 15, 20)  2680        input_4[0][0]                    
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 100, 300)     4451700     input_3[0][0]                    
__________________________________________________________________________________________________
time_distributed_4 (TimeDistrib (None, 100, 48)      13248       time_distributed_3[0][0]         
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 100, 348)     0           embedding_3[0][0]                
                                                                 time_distributed_4[0][0]         
__________________________________________________________________________________________________
lstm_4 (LSTM)                   (None, 128)          244224      concatenate_2[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 4)            516         lstm_4[0][0]                     
==================================================================================================
Total params: 4,712,368
Trainable params: 260,668
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Epoch 1/30
 - 60s - loss: 1.2737 - acc: 0.4937 - precision: 0.2479 - recall: 0.9915
Epoch 2/30
 - 59s - loss: 1.2532 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 3/30
 - 59s - loss: 1.2542 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 4/30
 - 59s - loss: 1.2543 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 5/30
 - 60s - loss: 1.2588 - acc: 0.4943 - precision: 0.2500 - recall: 1.0000
Epoch 6/30
 - 60s - loss: 1.2509 - acc: 0.4950 - precision: 0.2500 - recall: 1.0000
Epoch 7/30
 - 59s - loss: 1.2476 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 8/30
 - 60s - loss: 1.2471 - acc: 0.4959 - precision: 0.2500 - recall: 1.0000
Epoch 9/30
 - 59s - loss: 1.2003 - acc: 0.5069 - precision: 0.2500 - recall: 1.0000
Epoch 10/30
 - 59s - loss: 0.9439 - acc: 0.6064 - precision: 0.2500 - recall: 1.0000
Epoch 11/30
 - 59s - loss: 0.5869 - acc: 0.7980 - precision: 0.2500 - recall: 1.0000
Epoch 12/30
 - 59s - loss: 0.4472 - acc: 0.8478 - precision: 0.2500 - recall: 1.0000
Epoch 13/30
 - 60s - loss: 0.3843 - acc: 0.8707 - precision: 0.2500 - recall: 1.0000
Epoch 14/30
 - 60s - loss: 0.3409 - acc: 0.8834 - precision: 0.2500 - recall: 1.0000
Epoch 15/30
 - 60s - loss: 0.3175 - acc: 0.8924 - precision: 0.2500 - recall: 1.0000
Epoch 16/30
 - 59s - loss: 0.2981 - acc: 0.8974 - precision: 0.2500 - recall: 1.0000
Epoch 17/30
 - 60s - loss: 0.2819 - acc: 0.9037 - precision: 0.2500 - recall: 1.0000
Epoch 18/30
 - 59s - loss: 0.2639 - acc: 0.9111 - precision: 0.2500 - recall: 1.0000
Epoch 19/30
 - 60s - loss: 0.2534 - acc: 0.9121 - precision: 0.2500 - recall: 1.0000
Epoch 20/30
 - 60s - loss: 0.2361 - acc: 0.9171 - precision: 0.2500 - recall: 1.0000
Epoch 21/30
 - 60s - loss: 0.2183 - acc: 0.9258 - precision: 0.2500 - recall: 1.0000
Epoch 22/30
 - 60s - loss: 0.2059 - acc: 0.9296 - precision: 0.2500 - recall: 1.0000
Epoch 23/30
 - 60s - loss: 0.1973 - acc: 0.9326 - precision: 0.2500 - recall: 1.0000
Epoch 24/30
 - 60s - loss: 0.1879 - acc: 0.9352 - precision: 0.2500 - recall: 1.0000
Epoch 25/30
 - 60s - loss: 0.1806 - acc: 0.9370 - precision: 0.2500 - recall: 1.0000
Epoch 26/30
 - 60s - loss: 0.1741 - acc: 0.9402 - precision: 0.2500 - recall: 1.0000
Epoch 27/30
 - 60s - loss: 0.1693 - acc: 0.9408 - precision: 0.2500 - recall: 1.0000
Epoch 28/30
 - 59s - loss: 0.1651 - acc: 0.9431 - precision: 0.2500 - recall: 1.0000
Epoch 29/30
 - 59s - loss: 0.1586 - acc: 0.9451 - precision: 0.2500 - recall: 1.0000
Epoch 30/30
 - 59s - loss: 0.1537 - acc: 0.9459 - precision: 0.2500 - recall: 1.0000
Using TensorFlow backend.
/home/jasabanta/miniconda3/envs/dl/lib/python3.5/site-packages/sklearn/base.py:251: UserWarning: Trying to unpickle estimator LabelPropagation from version 0.18 when using version 0.20.0. This might lead to breaking code or invalid results. Use at your own risk.
  UserWarning)
Creating solution file...
Traceback (most recent call last):
  File "Finalmodelrun.py", line 773, in <module>
    predictions = model.predict(testData[0], batch_size=BATCH_SIZE)
  File "/home/jasabanta/miniconda3/envs/dl/lib/python3.5/site-packages/keras/engine/training.py", line 1772, in predict
    check_batch_axis=False)
  File "/home/jasabanta/miniconda3/envs/dl/lib/python3.5/site-packages/keras/engine/training.py", line 120, in _standardize_input_data
    'Found: array with shape ' + str(data.shape))
ValueError: The model expects 2  arrays, but only received one array. Found: array with shape (2755, 100)
Processing training data...
Processing test data...
Extracting tokens...
Found 14838 unique tokens.
Populating embedding matrix...
Extracting tokens/ characters...
Found 134 unique charactertokens.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 100, 15, 10)  1340        input_2[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 100, 300)     4451700     input_1[0][0]                    
__________________________________________________________________________________________________
time_distributed_2 (TimeDistrib (None, 100, 40)      8160        time_distributed_1[0][0]         
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 100, 340)     0           embedding_1[0][0]                
                                                                 time_distributed_2[0][0]         
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 128)          240128      concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 4)            516         lstm_2[0][0]                     
==================================================================================================
Total params: 4,701,844
Trainable params: 250,144
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Retraining model on entire data to create solution file
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_3 (TimeDistrib (None, 100, 15, 20)  2680        input_4[0][0]                    
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 100, 300)     4451700     input_3[0][0]                    
__________________________________________________________________________________________________
time_distributed_4 (TimeDistrib (None, 100, 48)      13248       time_distributed_3[0][0]         
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 100, 348)     0           embedding_3[0][0]                
                                                                 time_distributed_4[0][0]         
__________________________________________________________________________________________________
lstm_4 (LSTM)                   (None, 128)          244224      concatenate_2[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 4)            516         lstm_4[0][0]                     
==================================================================================================
Total params: 4,712,368
Trainable params: 260,668
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Epoch 1/30
 - 59s - loss: 1.2746 - acc: 0.4936 - precision: 0.2479 - recall: 0.9915
Epoch 2/30
 - 59s - loss: 1.2518 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 3/30
 - 59s - loss: 1.2525 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 4/30
 - 59s - loss: 1.2522 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 5/30
 - 59s - loss: 1.2654 - acc: 0.4913 - precision: 0.2500 - recall: 1.0000
Epoch 6/30
 - 59s - loss: 1.2531 - acc: 0.4931 - precision: 0.2500 - recall: 1.0000
Epoch 7/30
 - 59s - loss: 1.2270 - acc: 0.4970 - precision: 0.2500 - recall: 1.0000
Epoch 8/30
 - 59s - loss: 1.0393 - acc: 0.5542 - precision: 0.2500 - recall: 1.0000
Epoch 9/30
 - 59s - loss: 0.6182 - acc: 0.7768 - precision: 0.2500 - recall: 1.0000
Epoch 10/30
 - 60s - loss: 0.4381 - acc: 0.8483 - precision: 0.2500 - recall: 1.0000
Epoch 11/30
 - 59s - loss: 0.3681 - acc: 0.8732 - precision: 0.2500 - recall: 1.0000
Epoch 12/30
 - 60s - loss: 0.3154 - acc: 0.8913 - precision: 0.2500 - recall: 1.0000
Epoch 13/30
 - 59s - loss: 0.2958 - acc: 0.8976 - precision: 0.2500 - recall: 1.0000
Epoch 14/30
 - 59s - loss: 0.2716 - acc: 0.9059 - precision: 0.2500 - recall: 1.0000
Epoch 15/30
 - 60s - loss: 0.2618 - acc: 0.9111 - precision: 0.2500 - recall: 1.0000
Epoch 16/30
 - 60s - loss: 0.2414 - acc: 0.9180 - precision: 0.2500 - recall: 1.0000
Epoch 17/30
 - 59s - loss: 0.2309 - acc: 0.9192 - precision: 0.2500 - recall: 1.0000
Epoch 18/30
 - 59s - loss: 0.2126 - acc: 0.9268 - precision: 0.2500 - recall: 1.0000
Epoch 19/30
 - 59s - loss: 0.2033 - acc: 0.9286 - precision: 0.2500 - recall: 1.0000
Epoch 20/30
 - 59s - loss: 0.1985 - acc: 0.9315 - precision: 0.2500 - recall: 1.0000
Epoch 21/30
 - 59s - loss: 0.1866 - acc: 0.9340 - precision: 0.2500 - recall: 1.0000
Epoch 22/30
 - 59s - loss: 0.1789 - acc: 0.9385 - precision: 0.2500 - recall: 1.0000
Epoch 23/30
 - 60s - loss: 0.1739 - acc: 0.9395 - precision: 0.2500 - recall: 1.0000
Epoch 24/30
 - 59s - loss: 0.1694 - acc: 0.9414 - precision: 0.2500 - recall: 1.0000
Epoch 25/30
 - 59s - loss: 0.1615 - acc: 0.9439 - precision: 0.2500 - recall: 1.0000
Epoch 26/30
 - 59s - loss: 0.1550 - acc: 0.9476 - precision: 0.2500 - recall: 1.0000
Epoch 27/30
 - 59s - loss: 0.1561 - acc: 0.9464 - precision: 0.2500 - recall: 1.0000
Epoch 28/30
 - 59s - loss: 0.1484 - acc: 0.9476 - precision: 0.2500 - recall: 1.0000
Epoch 29/30
 - 59s - loss: 0.1466 - acc: 0.9479 - precision: 0.2500 - recall: 1.0000
Epoch 30/30
 - 59s - loss: 0.1435 - acc: 0.9502 - precision: 0.2500 - recall: 1.0000
Using TensorFlow backend.
/home/jasabanta/miniconda3/envs/dl/lib/python3.5/site-packages/sklearn/base.py:251: UserWarning: Trying to unpickle estimator LabelPropagation from version 0.18 when using version 0.20.0. This might lead to breaking code or invalid results. Use at your own risk.
  UserWarning)
Creating solution file...
Completed. Model parameters: 
Learning rate : 0.010, LSTM Dim : 128, Dropout : 0.400, Batch_size : 256
Processing training data...
Processing test data...
Extracting tokens...
Found 14838 unique tokens.
Populating embedding matrix...
Extracting tokens/ characters...
Found 134 unique charactertokens.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 100, 15, 10)  1340        input_2[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 100, 300)     4451700     input_1[0][0]                    
__________________________________________________________________________________________________
time_distributed_2 (TimeDistrib (None, 100, 40)      8160        time_distributed_1[0][0]         
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 100, 340)     0           embedding_1[0][0]                
                                                                 time_distributed_2[0][0]         
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 128)          240128      concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 4)            516         lstm_2[0][0]                     
==================================================================================================
Total params: 4,701,844
Trainable params: 250,144
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Retraining model on entire data to create solution file
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_3 (TimeDistrib (None, 100, 15, 15)  2010        input_4[0][0]                    
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 100, 300)     4451700     input_3[0][0]                    
__________________________________________________________________________________________________
time_distributed_4 (TimeDistrib (None, 100, 48)      12288       time_distributed_3[0][0]         
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 100, 348)     0           embedding_3[0][0]                
                                                                 time_distributed_4[0][0]         
__________________________________________________________________________________________________
lstm_4 (LSTM)                   (None, 128)          244224      concatenate_2[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 4)            516         lstm_4[0][0]                     
==================================================================================================
Total params: 4,710,738
Trainable params: 259,038
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Epoch 1/30
 - 60s - loss: 1.2684 - acc: 0.4932 - precision: 0.2479 - recall: 0.9915
Epoch 2/30
 - 59s - loss: 1.2494 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 3/30
 - 59s - loss: 1.2501 - acc: 0.4928 - precision: 0.2500 - recall: 1.0000
Epoch 4/30
 - 60s - loss: 1.2421 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
Epoch 5/30
 - 59s - loss: 0.9722 - acc: 0.5904 - precision: 0.2500 - recall: 1.0000
Epoch 6/30
 - 59s - loss: 0.6194 - acc: 0.7775 - precision: 0.2500 - recall: 1.0000
Epoch 7/30
 - 59s - loss: 0.4598 - acc: 0.8391 - precision: 0.2500 - recall: 1.0000
Epoch 8/30
 - 59s - loss: 0.3866 - acc: 0.8686 - precision: 0.2500 - recall: 1.0000
Epoch 9/30
 - 60s - loss: 0.3502 - acc: 0.8797 - precision: 0.2500 - recall: 1.0000
Epoch 10/30
 - 60s - loss: 0.3200 - acc: 0.8925 - precision: 0.2500 - recall: 1.0000
Epoch 11/30
 - 59s - loss: 0.3010 - acc: 0.8982 - precision: 0.2500 - recall: 1.0000
Epoch 12/30
 - 59s - loss: 0.2823 - acc: 0.9052 - precision: 0.2500 - recall: 1.0000
Epoch 13/30
 - 59s - loss: 0.2706 - acc: 0.9098 - precision: 0.2500 - recall: 1.0000
Epoch 14/30
 - 59s - loss: 0.2598 - acc: 0.9127 - precision: 0.2500 - recall: 1.0000
Epoch 15/30
 - 59s - loss: 0.2489 - acc: 0.9159 - precision: 0.2500 - recall: 1.0000
Epoch 16/30
 - 60s - loss: 0.2364 - acc: 0.9219 - precision: 0.2500 - recall: 1.0000
Epoch 17/30
 - 59s - loss: 0.2304 - acc: 0.9225 - precision: 0.2500 - recall: 1.0000
Epoch 18/30
 - 60s - loss: 0.2191 - acc: 0.9253 - precision: 0.2500 - recall: 1.0000
Epoch 19/30
 - 59s - loss: 0.2166 - acc: 0.9275 - precision: 0.2500 - recall: 1.0000
Epoch 20/30
 - 59s - loss: 0.2068 - acc: 0.9301 - precision: 0.2500 - recall: 1.0000
Epoch 21/30
 - 59s - loss: 0.2026 - acc: 0.9311 - precision: 0.2500 - recall: 1.0000
Epoch 22/30
 - 59s - loss: 0.1911 - acc: 0.9356 - precision: 0.2500 - recall: 1.0000
Epoch 23/30
 - 59s - loss: 0.1886 - acc: 0.9362 - precision: 0.2500 - recall: 1.0000
Epoch 24/30
 - 59s - loss: 0.1818 - acc: 0.9379 - precision: 0.2500 - recall: 1.0000
Epoch 25/30
 - 59s - loss: 0.1768 - acc: 0.9393 - precision: 0.2500 - recall: 1.0000
Epoch 26/30
 - 60s - loss: 0.1685 - acc: 0.9441 - precision: 0.2500 - recall: 1.0000
Epoch 27/30
 - 59s - loss: 0.1622 - acc: 0.9453 - precision: 0.2500 - recall: 1.0000
Epoch 28/30
 - 59s - loss: 0.1604 - acc: 0.9457 - precision: 0.2500 - recall: 1.0000
Epoch 29/30
 - 59s - loss: 0.1560 - acc: 0.9475 - precision: 0.2500 - recall: 1.0000
Epoch 30/30
 - 59s - loss: 0.1586 - acc: 0.9469 - precision: 0.2500 - recall: 1.0000
Using TensorFlow backend.
/home/jasabanta/miniconda3/envs/dl/lib/python3.5/site-packages/sklearn/base.py:251: UserWarning: Trying to unpickle estimator LabelPropagation from version 0.18 when using version 0.20.0. This might lead to breaking code or invalid results. Use at your own risk.
  UserWarning)
Creating solution file...
Completed. Model parameters: 
Learning rate : 0.010, LSTM Dim : 128, Dropout : 0.400, Batch_size : 256
Processing training data...
Processing test data...
Extracting tokens...
Found 14838 unique tokens.
Populating embedding matrix...
Extracting tokens/ characters...
Found 134 unique charactertokens.
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_2 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 100, 15, 10)  1340        input_2[0][0]                    
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 100, 300)     4451700     input_1[0][0]                    
__________________________________________________________________________________________________
time_distributed_2 (TimeDistrib (None, 100, 40)      8160        time_distributed_1[0][0]         
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 100, 340)     0           embedding_1[0][0]                
                                                                 time_distributed_2[0][0]         
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 128)          240128      concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 4)            516         lstm_2[0][0]                     
==================================================================================================
Total params: 4,701,844
Trainable params: 250,144
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Retraining model on entire data to create solution file
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_4 (InputLayer)            (None, 100, 15)      0                                            
__________________________________________________________________________________________________
input_3 (InputLayer)            (None, 100)          0                                            
__________________________________________________________________________________________________
time_distributed_3 (TimeDistrib (None, 100, 15, 15)  2010        input_4[0][0]                    
__________________________________________________________________________________________________
embedding_3 (Embedding)         (None, 100, 300)     4451700     input_3[0][0]                    
__________________________________________________________________________________________________
time_distributed_4 (TimeDistrib (None, 100, 48)      12288       time_distributed_3[0][0]         
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 100, 348)     0           embedding_3[0][0]                
                                                                 time_distributed_4[0][0]         
__________________________________________________________________________________________________
lstm_4 (LSTM)                   (None, 160)          325760      concatenate_2[0][0]              
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 4)            644         lstm_4[0][0]                     
==================================================================================================
Total params: 4,792,402
Trainable params: 340,702
Non-trainable params: 4,451,700
__________________________________________________________________________________________________
Epoch 1/30
 - 59s - loss: 1.2605 - acc: 0.4898 - precision: 0.2479 - recall: 0.9915
Epoch 2/30
 - 58s - loss: 1.2461 - acc: 0.4956 - precision: 0.2500 - recall: 1.0000
